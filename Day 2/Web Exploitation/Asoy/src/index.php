<?php
    function callFunctionWithSignature($functionName, $param1, $param2, $param3) {
        if (!function_exists($functionName)) {
            throw new Exception("Function $functionName does not exist.");
        }

        if (!is_array($param1) || !is_array($param2) || !is_string($param3)) {
            throw new InvalidArgumentException("Invalid parameter types. Expected (array, array, string).");
        }

        return call_user_func_array($functionName, [$param1, $param2, $param3]);
    }

    function exampleFunction(array $arr1, array $arr2, string $str) {
        return [
            'array1' => $arr1,
            'array2' => $arr2,
            'string' => $str,
            'message' => "Function executed successfully."
        ];
    }

    $func_name = $_GET['function_name'];
    $param1 = $_GET['param1'];
    $param2 = $_GET['param2'];
    $param3 = $_GET['param3'];

    var_dump($param1);
    echo "<br>";

    var_dump($param2);
    echo "<br>";

    try {
        $result = callFunctionWithSignature($func_name, $param1, $param2, $param3);
        print_r($result);
    } catch (Exception $e) {
        echo 'Error: ' . $e->getMessage();
    }

    function callback($a, $b) {
        var_dump("Inside callback: ", $a, $b);
        echo "<br>";
    }

// Normal: http://localhost:15236/?function_name=exampleFunction&param1[]=1&param1[]=2&param2[]=1&param2[]=2&param3=hehehe
// Exploit: http://localhost:15236/?function_name=array_diff_uassoc&param1[phpinfo();]=999&param2[something]=999&param3=callback